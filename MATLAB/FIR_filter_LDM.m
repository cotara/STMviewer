clear all

 BL = 201;
 
 
 B= [1.01239241e-20, 3.048351573e-06, 7.073268989e-06, 1.218984107e-05, 1.851835805e-05,... 
  2.618411418e-05,3.531717084e-05,4.605209688e-05,5.852765753e-05,7.288649795e-05,...
  8.927478484e-05,0.0001078418063, 0.000128739528,0.0001521222002,0.0001781457977,...
  0.0002069675684, 0.000238745517,0.0002736377646, 0.000311802025,0.0003533949784,...
  0.0003985717485, 0.000447485043,0.0005002847174,0.0005571170477,0.0006181239733,...
  0.0006834425149, 0.000753203989, 0.000827533484,0.0009065489867,0.0009903607424,...
   0.001079070731, 0.001172771677, 0.001271546935, 0.001375469146, 0.001484600245,...
   0.001598990522, 0.001718678046, 0.001843688544, 0.001974034123, 0.002109713387,...
   0.002250710968, 0.002396997064,  0.00254852674, 0.002705239924, 0.002867061179,...
   0.003033899469, 0.003205647925, 0.003382183379,  0.00356336683, 0.003749043681,...
   0.003939042334,  0.00413317699,  0.00433124369, 0.004533025436,    0.004738288,...
   0.004946784116, 0.005158249754, 0.005372409243,  0.00558897201, 0.005807634443,...
   0.006028080825, 0.006249983795, 0.006473004818, 0.006696795579, 0.006920997519,...
   0.007145245094,  0.00736916298, 0.007592371199, 0.007814482786, 0.008035107516,...
   0.008253849111, 0.008470309898, 0.008684092201, 0.008894796483, 0.009102023207,...
   0.009305376559, 0.009504462592, 0.009698891081,  0.00988827832,  0.01007224713,...
     0.0102504259,  0.01042245422,  0.01058797911,  0.01074665971,  0.01089816727,...
    0.01104218606,  0.01117841247,  0.01130655874,  0.01142635476,  0.01153754257,...
    0.01163988654,  0.01173316501,  0.01181717683,  0.01189174037,  0.01195669454,...
    0.01201189775,  0.01205722895,  0.01209259033,  0.01211790368,  0.01213311404,...
    0.01213818789,  0.01213311404,  0.01211790368,  0.01209259033,  0.01205722895,...
    0.01201189775,  0.01195669454,  0.01189174037,  0.01181717683,  0.01173316501,...
    0.01163988654,  0.01153754257,  0.01142635476,  0.01130655874,  0.01117841247,...
    0.01104218606,  0.01089816727,  0.01074665971,  0.01058797911,  0.01042245422,...
     0.0102504259,  0.01007224713,  0.00988827832, 0.009698891081, 0.009504462592,...
   0.009305376559, 0.009102023207, 0.008894796483, 0.008684092201, 0.008470309898,...
   0.008253849111, 0.008035107516, 0.007814482786, 0.007592371199,  0.00736916298,...
   0.007145245094, 0.006920997519, 0.006696795579, 0.006473004818, 0.006249983795,...
   0.006028080825, 0.005807634443,  0.00558897201, 0.005372409243, 0.005158249754,...
   0.004946784116,    0.004738288, 0.004533025436,  0.00433124369,  0.00413317699,...
   0.003939042334, 0.003749043681,  0.00356336683, 0.003382183379, 0.003205647925,...
   0.003033899469, 0.002867061179, 0.002705239924,  0.00254852674, 0.002396997064,...
   0.002250710968, 0.002109713387, 0.001974034123, 0.001843688544, 0.001718678046,...
   0.001598990522, 0.001484600245, 0.001375469146, 0.001271546935, 0.001172771677,...
   0.001079070731,0.0009903607424,0.0009065489867, 0.000827533484, 0.000753203989,...
  0.0006834425149,0.0006181239733,0.0005571170477,0.0005002847174, 0.000447485043,...
  0.0003985717485,0.0003533949784, 0.000311802025,0.0002736377646, 0.000238745517,...
  0.0002069675684,0.0001781457977,0.0001521222002, 0.000128739528,0.0001078418063,...
  8.927478484e-05,7.288649795e-05,5.852765753e-05,4.605209688e-05,3.531717084e-05,...
  2.618411418e-05,1.851835805e-05,1.218984107e-05,7.073268989e-06,3.048351573e-06,...
   1.01239241e-20
];

load data

dx_mas_counter =1;

dx_mas = zeros(BL,1);

for j=1:10000
    
    dx = data(j,2);
    
    dx_mas(dx_mas_counter) = dx;   
     
     
     
      Yx = B(1) ;
    
     
     
     for i = 2:BL
     
       dx_mas_counter_offset =dx_mas_counter+i-2;
       if dx_mas_counter_offset>BL
          dx_mas_counter_offset= dx_mas_counter_offset-(BL);
       end
        
       Yx=Yx+B(i)*dx_mas(dx_mas_counter_offset);
      
         
     
     end    
     
      dx_mas_counter=dx_mas_counter+1;
      if dx_mas_counter == BL+1
      
            dx_mas_counter=1;
      end
     old_x(j) = Yx; 
    
end

plot(data(:,1),data(:,2),data(:,1),old_x)